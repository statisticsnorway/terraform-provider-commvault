# Go API client for apiexplorer

Commvault APIs

## Overview

Endpoints are implemented based on [Api doc for SP36](https://api.commvault.com/docs/SP36/commvault-rest-api-public/).

The API client is based on code generated by the [swagger-codegen](https://github.com/swagger-api/swagger-codegen)
project.

## Installation

Put the package under your project folder and add the following in import:

```golang
import "statisticsnorway/terraform-provider-commvault/pkg/commvault/apiclient"
```

## Documentation for API Endpoints

See each `<domain>_api.go` for documentation of the avaiable endpoints. `apiclient.go` is a good start point to view all
available methods.

## Documentation For Authorization

### token

- **Type**: API key

Example

```golang
apiClient := apiclient.NewAPIClient(&apiclient.Configuration{
    BasePath: urlToCommvaultApi,
    UserAgent:  "my-application",
    HTTPClient: httpClient, // decleared
})

loginResponse, _, err := apiClient.LoginApi.Login(ctx, &apiclient.LoginRequest{
    Username: commvaultUsername,
    Password: commvaultPasswordBase64Encoded,
})
if err != nil {
    // TODO: Handle error
    return
}
// Set token, which will now be used for the rest of all api calls. Alternativly token can be set via Context
apiClient.SetToken(loginResponse.Token)
```

## Author

## Other

### Why have apiclient as its own package?

We want the API client to be able to have a different lifecycle then the rest of the repo.
Another reason is that we don't want the overhead of the whole collection of packages when we import this module from another project.
See: https://go.dev/wiki/Modules#faqs--multi-module-repositories

### Why not generate the apiclient with OpenAPI spec or Postman collection?

The OpenAPI spec provided from the ApiExplorer in Commvault Command Center,  Postman collection hosted on [github](https://github.com/Commvault/Rest-API-Postman-Collection/tree/master) and Postman collection hosted on https://documentation.commvault.com/2023e/essential/rest_api_postman.html (last accessed 20. aug 2025) all differed, as well as the [official documentation](https://api.commvault.com/docs/SP36/commvault-rest-api-public/)  had endpoints which differed from the specs mentioned above.

The conclusion was therefore that it is easier to implement the method needed by hand, but by using the swagger codegen layout as inspiration for how the files and ApiClient is modeled.

